/*! EnerFeel 2014-03-18 */
angular.module("app",["ui.slider","ngRoute","ui.bootstrap.dropdown","ngCookies","ngRoute","d3","ngQuickDate","app.services","app.graphDirective","app.directives","app.controllers"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/notLoggedIn.ejs"}).when("/view/main",{templateUrl:"partials/main.ejs"}).when("/view/graph",{templateUrl:"partials/graph.ejs"}).when("/view/log",{templateUrl:"partials/log.ejs"})}]),angular.module("app").run(["$templateCache",function(a){"use strict";a.put("directiveTemplates/addCategoryTemplate.html",' <span ng-show=showAddCategories><div class=addCategory class=margin-topbottom-oneEm><button class="floatLeft marginRight-pointSevenFive" ng-click="showAddCategories_add = !showAddCategories_add">New Category</button> <span class=floatLeft ng-show=showAddCategories_add><form name=addCategoryForm novalidate class=addCategoryTemplate-addCategoryForm><input ng-model=categories.newCategory.label placeholder="Name of category" required><input ng-model=categories.newCategory.size placeholder="Size scale" required><input ng-model=categories.newCategory.opacity placeholder="Opacity scale" required><button ng-click=categories.add(categories.newCategory) ng-disabled=addCategoryForm.$invalid>Add Category</button>  <span class="error addCategoryTemplate-addError" ng-show=addCategoryTemplateAddCategoryError>Error! Please try again.</span></form></span></div><div class=margin-topbottom-oneEm><button class="floatLeft marginRight-pointSevenFive" ng-click="showAddCategories_delete = !showAddCategories_delete">Delete Category</button> <span class=floatLeft ng-show=showAddCategories_delete><form name=deleteCategoryForm novalidate class=addCategoryTemplate-deleteCategoryForm><select ng-model=categories.selected.categoryToDelete ng-options="category as category.label for category in categories.list"></select><button ng-click=categories.delete(categories.selected.categoryToDelete) ng-disabled="categories.selected.categoryToDelete.label ===\'meal\' || \n				categories.selected.categoryToDelete.label ===\'exercise\' ||\n				categories.selected.categoryToDelete.label ===\'work\' ||\n				categories.selected.categoryToDelete.label ===\'sleep\'">Delete</button>  <span class="error addCategoryTemplate-DeleteError" ng-show=addCategoryTemplateDeleteCategoryError>Error! Please try again.</span></form></span></div></span>'),a.put("directiveTemplates/addTemplate.html",'<div ng-show=showAdd><form name=addForm novalidate class=addTemplate-addForm><span time="" required></span> <div class=sliderWidth ui-slider="{orientation: \'horizontal\', range: \'min\'}" min=0 max=5 step=1 ng-model=input.level required></div><span class=energyLevelCaption required>Energy level: {{input.level}}</span> <input class=addNote ng-model=input.note placeholder=Note required><span category-options-list="" required></span>  <button ng-click="addEvent(input.level, input.note, categories.selected.category.value)" ng-disabled="addForm.$invalid ||  categories.selected.category.label === \'Choose a category\' || input.size == null || input.opacity == null" ng-class="{\'button-color\': addForm.$valid && categories.selected.category.label !== \'Choose a category\' && input.size != null && input.opacity != null}">Add</button> <div class=addNotice><span class=red ng-show="addForm.$invalid ||  categories.selected.category.label === \'Choose a category\' || input.size == null || input.opacity == null">Please fill out all inputs.</span> <span class=green ng-hide="addForm.$invalid ||  categories.selected.category.label === \'Choose a category\' || input.size == null || input.opacity == null">Ready to add!</span></div><span class="error addTemplate-addError" ng-show=addTemplateAddError>Error! Please try again.</span> <div more-category-inputs=""></div></form></div>'),a.put("directiveTemplates/categoryOptionsListTemplate.html",'<select ng-model=categories.selected.category ng-options="category as category.label for category in categories.list"></select>'),a.put("directiveTemplates/customTimeFilterTemplate.html",'<span class=customTime><datepicker ng-model=calendar.firstDate></datepicker><datepicker ng-model=calendar.secondDate></datepicker><button ng-click="customLengthTime(calendar.firstDate, calendar.secondDate)">Custom</button></span>'),a.put("directiveTemplates/filterTemplate.html",'<span ng-show=showFilterdir><div class=filterTemplate-timeFilters>Time Filters <button ng-click="filterTime(\'day\')">Day</button> <button ng-click="filterTime(\'week\')">Week</button> <button ng-click="filterTime(\'month\')">Month</button> <button ng-click=resetFilters()>All</button> <button ng-click="showCustomTime = !showCustomTime">Custom timeframe</button> <span ng-show=showCustomTime><span custom-time-filter=""></span></span></div><div>Activity Filters <button ng-click="filterCategory(\'meal\')">Meal</button> <button ng-click="filterCategory(\'exercise\')">Exercise</button> <button ng-click="filterCategory(\'work\')">Work</button> <button ng-click="filterCategory(\'sleep\')">Sleep</button> <button ng-click=resetFilters()>None</button></div></span>'),a.put("directiveTemplates/modifyTemplate.html",'<div ng-show=showModify><div><form name=modifyForm novalidate class=modifyTemplate-modifyForm><div class=modifyTimeSpan>{{event.selected.date | date:\'medium\'}}</div><div class="sliderWidth modify-e-slider" ui-slider="{orientation: \'horizontal\', range: \'min\'}" min=0 max=5 step=1 ng-model=event.selected.energylevel></div><span class=modify-e-caption>Energy Level: {{event.selected.energylevel}}</span></form></div><div><input class=modifyTemplate-noteSize ng-model=event.selected.note placeholder=Note minlength=1><button ng-click=updateEvent(event) ng-disabled="modifyForm.$invalid || event.selected.energylevel == null || event.selected.note.length < 1">Update Event</button> <button ng-click=deleteEvent(event) ng-disabled=modifyForm.$invalid>Delete Event</button> <span class="error modifyTemplate-addError" ng-show=modifyTemplateAddError>Error! Please try again.</span></div></div>'),a.put("directiveTemplates/moreCategoryInputsTemplate.html",'<div class=moreCategoryInputsTemplate><div ng-show=show.meal><div class=mealSlider-caption><div class="sliderWidth sliderInMeal sizeSlider" ui-slider="{orientation: \'horizontal\', range: \'min\'}" min=0 max=5 step=1 ng-model=input.size></div><span>How full do you feel? {{input.size}}</span></div><form><input ng-model=input.checkbox.dairy type=checkbox>Dairy<input ng-model=input.checkbox.fruits type=checkbox>Fruits<input ng-model=input.checkbox.grains type=checkbox>Grains<input ng-model=input.checkbox.meat type=checkbox>Meat<input ng-model=input.checkbox.vegetables type=checkbox>Vegetables</form></div><div ng-repeat="category in categories.list" class=cat><div ng-show={{category.show}} class={{category.label}}><div><span class=moreCategories-slider-caption>{{category.size}}: {{input.size}}</span><div class="sliderWidth slidersInMoreCategories sizeSlider" ui-slider="{orientation: \'horizontal\', range: \'min\'}" min=0 max={{category.sizeCeiling}} step=1 ng-model=input.size></div><div class="sliderWidth slidersInMoreCategories opacitySlider" ui-slider="{orientation: \'horizontal\', range: \'min\'}" min=0 max={{category.opacityCeiling}} step=1 ng-model=input.opacity></div><span class=moreCategories-slider-caption>{{category.opacity}}: {{input.opacity}}</span></div></div></div></div>'),a.put("directiveTemplates/larger_components/graph_component.html","<graph data=lifeEventsInView category=category.setTo select=event.selected></graph>"),a.put("directiveTemplates/larger_components/instructions_component.html","<span><h3>About</h3><p>I once performed a experiment: for 21 days, I recorded in a journal all of my daily activities, include meals, exercise, work habits, and energy level.</p><p>On the days I exercised for 30 minutes, I tended to be more productive. On days I drank coffee, I found an extra-focused 2 1/2 hours of productivity. Analyzing my days, I gained a new sense of self awareness.</p>But what if I could create a tool to track and analyze my productivity? Productive Journal is my answer. This page shows sample data for how a user might use this app to find trends in their schedule.<p><b>ADD events:</b> From meals, exercising, or anything you choose to track.</p><p><b>MODIFY events:</b> Make a mistake adding an event? No problem.</p><p><b>CREATE:</b> your own categories.</p><p><b>FILTER:</b> by time (day, week, month, custom!), or activity (meal, exercise, etc). In the list-view, you can also click Date to show events from a certain date; Time to filter events at a certain time (eg. eating dinner at 7pm everyday), and by category.</p><p><b>SIGN UP:</b> for your own account today!</p></span> "),a.put("directiveTemplates/larger_components/log_component.html","<div class=log ng-show=\"lifeEventsInView.length > 0\"><table class=log-table><th ng-click=resetFilters()>Date</th><th ng-click=resetFilters()>Time</th><th ng-click=resetFilters()>Category</th><th ng-click=resetFilters()>Note</th><tr class=events-in-log ng-repeat=\"event in lifeEventsInView track by $index | filter: filters\"><td ng-click=filterDate(event.date)>{{event.date | date:'shortDate'}}</td><td ng-click=filterHour(event.date)>{{event.date | date:'shortTime'}}</td><td ng-click=filterCategory(event.category)>{{event.category | limitTo: 15}}</td><td class=trimmed-notes>{{event.note | limitTo: 22}}</td></tr></table></div>"),a.put("directiveTemplates/larger_components/loglarge_component.html",'<div class="log log-view-large" ng-show="lifeEventsInView.length > 0"><table class=log-table><th ng-click=resetFilters()>Date</th><th ng-click=resetFilters()>Time</th><th ng-click=resetFilters()>Category</th><th ng-click=resetFilters()>Energy</th><th ng-click=resetFilters()>Size</th><th ng-click=resetFilters()>Opacity</th><th class=notesCursor ng-click=resetFilters()>Note</th><tr class=events-in-log ng-repeat="event in lifeEventsInView | filter: filters"><td ng-click=filterDate(event.date)>{{event.date | date:\'shortDate\'}}</td><td ng-click=filterHour(event.date)>{{event.date | date:\'shortTime\'}}</td><td ng-click=filterCategory(event.category)>{{event.category}}</td><td ng-click=filterEnergy(event.energylevel)>{{event.energylevel}}</td><td ng-click=filterSize(event.size)>{{event.size}}</td><td ng-click=filterOpacity(event.opacity)>{{event.opacity}}</td><td class=notesCursor>{{event.note}}</td></tr></table></div><instructions class="inlineblock instructions log" ng-show=showInstructions></instructions>'),a.put("directiveTemplates/larger_components/logsmall_component.html",'<div class=inlineblock ng-show=!showInstructions><div class=log ng-show="lifeEventsInView.length > 0"><table class=log-table><th ng-click=resetFilters()>Date</th><th ng-click=resetFilters()>Time</th><th ng-click=resetFilters()>Category</th><th class=notesCursor ng-click=resetFilters()>Note</th><tr class=events-in-log ng-repeat="event in lifeEventsInView track by $index | filter: filters"><td ng-click=filterDate(event.date)>{{event.date | date:\'shortDate\'}}</td><td ng-click=filterHour(event.date)>{{event.date | date:\'shortTime\'}}</td><td ng-click=filterCategory(event.category)>{{event.category | limitTo: 15}}</td><td class=notesCursor>{{event.note | limitTo: 22}}</td></tr></table></div></div><instructions class="inlineblock instructions log" ng-show=showInstructions></instructions>'),a.put("directiveTemplates/larger_components/navbar-loggedIn_component.html",'<nav class="navbar navbar-default cf navbar-higher"><div class=navbar-view-options><span class=button-outer><span class="pad-right opacity-half"><a href=#/view/graph><i class="lower-lg-icon fa fa-bar-chart-o fa-lg"></i></a></span> <span class="pad-right opacity-half"><a href=#/view/log><i class="lower-lg-icon fa fa-list-alt fa-lg"></i></a></span> <span class="pad-right opacity-half"><a href=#/view/main><i class="lower-lg-icon fa fa-bar-chart-o"></i><i class="small fa fa-list-alt"></i></a></span></span><div class=navbar-text-view>View</div></div><div class=navbar-add-event ng-click="showInNav(\'showAdd\')"><i class="opacity-half lower-2x-icon fa fa-plus-circle fa-2x"></i><div class=navbar-text-add>Add Event</div></div><div class="navbar-account opacity-half"><i class="lower-lg-icon fa fa-calendar-o fa-lg"></i><li class="dropdown navbar-text-account"><a class=dropdown-toggle>My Account</a><ul class=dropdown-menu><li><a ng-click=logout()><i class="fa fa-share"></i> Sign out</a></li></ul></li><i class="lower-lg-icon fa fa-angle-down fa-lg"></i></div></nav>'),a.put("directiveTemplates/larger_components/navbar-lower_component.html",'<div class="navbar navbar-lower navbar-default-lower cf"><ul class=lower-navbar-items><button ng-click="showInNav(\'showAddCategories\')">Categories</button> <button ng-click="showInNav(\'showModify\')">Modify Events</button> <button ng-click="showInNav(\'showFilterdir\')">Filter</button></ul><i ng-click="showInstructions = !showInstructions" class="toggle-instructions-icon fa fa-question fa-2x"></i></div>'),a.put("directiveTemplates/larger_components/navbarnotLoggedIncomponent.html",'<nav class="navbar navbar-default cf navbar-higher"><div class=navbar-view-options><span class=button-outer><span class="pad-right opacity-half"><a href=#/view/graph><i class="lower-lg-icon fa fa-bar-chart-o fa-lg"></i></a></span> <span class="pad-right opacity-half"><a href=#/view/log><i class="lower-lg-icon fa fa-list-alt fa-lg"></i></a></span> <span class="pad-right opacity-half"><a href=#/view/main><i class="lower-lg-icon fa fa-bar-chart-o"></i><i class="small fa fa-list-alt"></i></a></span></span><div class=navbar-text-view>View</div></div><div class=navbar-add-event ng-click="showInNav(\'showAdd\')"><i class="opacity-half lower-2x-icon fa fa-plus-circle fa-2x"></i><div class=navbar-text-add>Add Event</div></div><div class=navbar-signup ng-click=loadData()><i class="opacity-half lower-lg-icon fa fa-facebook-square fa-lg">Sign up</i></div><div class=navbar-login-notSignedIn ng-click=loadData()><i class="opacity-half lower-lg-icon fa fa-facebook-square fa-lg">Login</i></div></nav>'),a.put("directiveTemplates/larger_components/options-area_component.html",'<div class=options-area><div class=options-area-component ng-show=showFilterdir filterdir=""></div><div class=options-area-component ng-show=showAddCategories add-category=""></div><div class=options-area-component ng-show=showModify modify=""></div><div class=options-area-component ng-show=showAdd add=""></div><div class="sampleData options-area-sampleData" ng-hide="hideSampleDataHeader || eventService.Auth.authLevel > 0">This sample page shows how you might use this tool to track your productivity and energy level. Feel free to try it! Add new events, filter them, and so on. <span class=closeSampleDataHeader ng-click="hideSampleDataHeader = !hideSampleDataHeader">X</span></div><div class="error options-area-loadDataError" ng-show=optionsAreaLoadDataError>Error! Please try logging in again.</div></div>'),a.put("partials/backupMain.ejs",'<nav class="navbar navbar-default"><div class=navbar-view-options><span class=button-outer><span class=icon><i class="lower-lg-icon fa fa-bar-chart-o fa-lg"></i></span> <span class=icon><i class="lower-lg-icon fa fa-list-alt fa-lg"></i></span> <span class=icon><i class="lower-lg-icon fa fa-bar-chart-o"></i><i class="small fa fa-list-alt"></i></span></span><div class=navbar-text-view>View</div></div><div class=navbar-add-event ng-click="showInNav(\'showAdd\')"><i class="lower-2x-icon fa fa-plus-circle fa-2x"></i><div class=navbar-text-add>Add Event</div></div><div class=navbar-account><i class="lower-lg-icon fa fa-calendar-o fa-lg"></i><li class="dropdown navbar-text-account"><a class=dropdown-toggle>My Account</a><ul class=dropdown-menu><li><a href=#><i class="fa fa-cog fa-lg"></i> Settings</a></li><li><a href=#><i class="fa fa-share"></i> Sign out</a></li></ul></li><i class="lower-lg-icon fa fa-angle-down fa-lg"></i></div><div class=navbar-login ng-click=loadData()><i class="lower-lg-icon fa fa-facebook-square fa-lg">Login</i></div></nav><div class="navbar navbar-lower navbar-default"><ul class=lower-navbar-items><button ng-click="showInNav(\'showAddCategories\')">Categories</button> <button ng-click="showInNav(\'showModify\')">Events</button> <button ng-click="showInNav(\'showFilterdir\')">Time/Activity Filter</button></ul></div><article><div class=options-area><div filterdir=""></div><div add-category=""></div><div modify=""></div><div add=""></div></div><graph data=lifeEventsInView category=category.setTo select=event.selected></graph><div class=log ng-show="lifeEventsInView.length > 0"><table class=log-table><th ng-click=resetFilters()>Date</th><th ng-click=resetFilters()>Time</th><th ng-click=resetFilters()>Category</th><th ng-click=resetFilters()>Note</th><tr class=events-in-log ng-repeat="event in lifeEventsInView track by $index | filter: filters"><td ng-click=filterDate(event.date)>{{event.date | date:\'shortDate\'}}</td><td ng-click=filterHour(event.date)>{{event.date | date:\'shortTime\'}}</td><td ng-click=filterCategory(event.category)>{{event.category | limitTo: 15}}</td><td class=trimmed-notes>{{event.note | limitTo: 22}}</td></tr></table></div></article>'),a.put("partials/graph.ejs",'<nav navbarloggedin=""></nav><div navbarlower=""></div><article><optionsarea></optionsarea><graphlargercomponents class=graph-view-large></graphlargercomponents><instructions class="inlineblock instructions log" ng-show=showInstructions></instructions></article>'),a.put("partials/log.ejs",'<nav navbarloggedin=""></nav><div navbarlower=""></div><article><optionsarea></optionsarea><loglarge></loglarge></article>'),a.put("partials/main.ejs",'<nav navbarloggedin=""></nav><div navbarlower=""></div><article><optionsarea></optionsarea><graphlargercomponents></graphlargercomponents><logsmall></logsmall></article>'),a.put("partials/notLoggedIn.ejs",'<div navbarnotloggedin=""></div><div navbarlower=""></div><article><optionsarea></optionsarea><graphlargercomponents></graphlargercomponents><logsmall></logsmall></article>')}]),angular.module("app.controllers",[]).controller("mainCtrl",["$scope","EventService","FilterService","CategoryService","MockData","$timeout",function(a,b,c,d,e,f){a.eventService=b,a.filterService=c,a.lifeEventsInView=c.filterLifeEvents("all"),a.input={},a.category={},a.category.setTo="null",a.filters={},a.login=function(){b.login()},a.logout=function(){function a(){b.allLifeEvents=[],b.allLifeEvents=e}b.logout(a)},a.loadData=function(){function d(){a.optionsAreaLoadDataError&&(a.optionsAreaLoadDataError=!1);for(var d=0;d<b.allLifeEvents.length;d++)a.lifeEventsInView.push(b.allLifeEvents[d]);c.sortTime(a.lifeEventsInView)}function e(){a.optionsAreaLoadDataError=!0}0===b.Auth.authLevel?a.login():b.Auth.authLevel>0&&b.getData(d,e)},b.Auth.authLevel>0&&a.loadData(),a.$on("filterSomething",function(b,c){a.lifeEventsInView=c}),f(function(){a.hideSampleDataHeader=!0},3e4)}]),angular.module("app.directives",[]).controller("AddController",["$scope","$timeout","CategoryService",function(a){a.show={},a.input.checkbox={},a.input.checkbox.checked=0,a.addIfSleep=function(b,c,d,e,f){var g={energylevel:b,note:c,category:d,opacity:e,size:f,date:new Date((new Date).getTime()-36e5*f)};a.pushDataIntoServices(g)},a.pushDataIntoServices=function(b){function c(){a.addTemplateAddError&&(a.addTemplateAddError=!1),a.eventService.allLifeEvents.push(b),a.lifeEventsInView.push(b),a.filterService.sortTime(a.lifeEventsInView),a.resetInputsCategories()}function d(){a.addTemplateAddError=!0}a.eventService.addLifeEvent(b,c,d)},a.resetInputsCategories=function(){for(prop in a.input)a.input[prop]=null;a.showAdd=!1,a.showHideCategories("all"),a.categories.selected.category=a.categories.list[0],a.addForm.$setPristine()},a.createEventDataObj=function(b,c,d){var e={energylevel:b,note:c,date:a.dateTimePicked,category:d,opacity:a.input.opacity,size:a.input.size};return e},a.addEvent=function(b,c,d){var e=a.input.opacity,f=a.input.size,g=a.createEventDataObj(b,c,d);a.pushDataIntoServices(g),"sleep"===d&&a.addIfSleep(b,c,d,e,f)},a.$watch("input.checkbox",function(){null==a.input.checkbox&&(a.input.checkbox={}),a.input.checkbox.checked=0;for(food in a.input.checkbox)a.input.checkbox[food]===!0&&a.input.checkbox.checked++;a.input.checkbox.checked>0&&(a.input.opacity=a.input.checkbox.checked)},!0)}]).directive("add",[function(){return{restrict:"EA",controller:"AddController",templateUrl:"directiveTemplates/addTemplate.html"}}]).controller("timeController",["$scope","$timeout",function(a,b){function c(){var c=new Date,e=c.getSeconds(),f=1e3*(60-e);b(function(){a.dateTimePicked=new Date,d()},f)}a.dateTimePicked=new Date,c();var d=function(){cancelRefresh=b(function c(){a.dateTimePicked=new Date,cancelRefresh=b(c,6e4)},6e4)};a.$on("destroy",function(){b.cancel(cancelRefresh)})}]).directive("time",["$timeout",function(){return{restrict:"EA",controller:"timeController",template:'<datepicker ng-model="dateTimePicked"></datepicker>'}}]).controller("moreCategoryInputsController",["$scope","CategoryService",function(a,b){function c(){a.showHideCategories(a.categories.selected.category.value)}a.categories={},a.categories.categoryService=b,a.categories.list=a.categories.categoryService.categoriesObj.list,a.show={};for(var d=0;d<a.categories.list.length;d++)null==a.show[a.categories.list[d].label]&&(a.show[a.categories.list[d].label]=!1);a.categories.selected={},a.categories.selected.category=a.categories.list[0],a.showHideCategories=function(b){for(category in a.show)a.show[category]=category!==b?!1:!0},a.$watch("categories.selected.category",c,!0),a.categories.add=function(c){function d(){a.addCategoryTemplateAddCategoryError&&(a.addCategoryTemplateAddCategoryError=!1),a.categories.list=b.categoriesObj.list,a.show[c.label]=!1,a.categories.newCategory={}}function e(){a.addCategoryTemplateAddCategoryError=!0}a.categories.categoryService.addCategory(c,d,e)},a.categories.newCategory={},a.categories.selected.categoryToDelete=a.categories.list[0],a.categories.delete=function(b){function c(){a.addCategoryTemplateDeleteCategoryError&&(a.addCategoryTemplateDeleteCategoryError=!1),a.categories.selected.categoryToDelete=a.categories.list[0]}function d(){a.addCategoryTemplateDeleteCategoryError=!0}a.categories.categoryService.deleteCategory(b,c,d)},a.showInNav=function(b){"showModify"===b?(a.showModify=!a.showModify,a.showAddCategories=!1,a.showFilterdir=!1,a.showAdd=!1):"showAddCategories"===b?(a.showAddCategories=!a.showAddCategories,a.showModify=!1,a.showFilterdir=!1,a.showAdd=!1):"showFilterdir"===b?(a.showAddCategories=!1,a.showModify=!1,a.showFilterdir=!a.showFilterdir,a.showAdd=!1):"showAdd"===b&&(a.showAddCategories=!1,a.showModify=!1,a.showFilterdir=!1,a.showAdd=!a.showAdd)}}]).directive("moreCategoryInputs",[function(){return{restrict:"EA",controller:"moreCategoryInputsController",templateUrl:"directiveTemplates/moreCategoryInputsTemplate.html"}}]).directive("addCategory",[function(){return{restrict:"EA",controller:"moreCategoryInputsController",templateUrl:"directiveTemplates/addCategoryTemplate.html"}}]).controller("modifyController",["$scope","FilterService","EventService",function(a,b){function c(){a.showModify===!0&&(a.event={},a.event.selected)}a.event={},a.event.selected,a.$watch("showModify",c,!0),a.showModifyFunc=function(){a.showModify===!0?(a.showModify=!1,a.event={},a.event.selected):a.showModify=!0},a.deleteEvent=function(b){function c(){a.modifyTemplateAddError&&(a.modifyTemplateAddError=!1),a.lifeEventsInView=a.filterService.filterLifeEvents(a.filterService.currentFilterObj.time)}function d(){a.modifyTemplateAddError=!0}a.eventService.deleteLifeEvent(b.selected,c,d)},a.updateEvent=function(c){function d(){a.modifyTemplateAddError&&(a.modifyTemplateAddError=!1),a.lifeEventsInView=a.filterService.filterLifeEvents(b.currentFilterObj.time)}function e(){a.modifyTemplateAddError=!0}c&&a.eventService.updateLifeEvent(c.selected,d,e)},a.modifyDate=new Date}]).directive("modify",[function(){return{restrict:"EA",controller:"modifyController",templateUrl:"directiveTemplates/modifyTemplate.html"}}]).controller("filterController",["EventService","FilterService","$scope",function(a,b,c){function d(){c.$emit("filterSomething",c.lifeEventsInView)}c.category={},c.category.setTo="null",c.filterTime=function(a){c.lifeEventsInView=b.filterLifeEvents(a),d()},c.filterCategory=function(a){c.lifeEventsInView=b.filterActivity(a),d()},c.filterHour=function(a){c.lifeEventsInView=b.filterHour(a),d()},c.filterDate=function(a){c.lifeEventsInView=b.filterDate(a),d()},c.filterEnergy=function(a){c.lifeEventsInView=b.filterEnergy(a),d()},c.filterOpacity=function(a){c.lifeEventsInView=b.filterOpacity(a),d()},c.filterSize=function(a){c.lifeEventsInView=b.filterSize(a),d()},c.resetFilters=function(){c.lifeEventsInView=b.sortTime(a.allLifeEvents),d()},c.calendar={},c.calendar.firstDate=new Date,c.calendar.secondDate=new Date,c.customLengthTime=function(a,b){c.lifeEventsInView=c.filterService.customFilterLifeEvents(a,b)}}]).directive("filterdir",[function(){return{restrict:"EA",controller:"filterController",templateUrl:"directiveTemplates/filterTemplate.html"}}]).directive("customTimeFilter",[function(){return{restrict:"EA",controller:"filterController",templateUrl:"directiveTemplates/customTimeFilterTemplate.html"}}]).controller("categoryOptionsListController",["CategoryService","$scope",function(a,b){b.categories={},b.categories.categoryService=a,b.categories.list=b.categories.categoryService.categoriesObj.list,b.categories.selected={},b.categories.selected.category=b.categories.list[0]}]).directive("categoryOptionsList",[function(){return{restrict:"EA",controller:"categoryOptionsListController",templateUrl:"directiveTemplates/categoryOptionsListTemplate.html"}}]).directive("navbarnotloggedin",[function(){return{restrict:"EA",controller:"mainCtrl",templateUrl:"directiveTemplates/larger_components/navbarnotLoggedIncomponent.html"}}]).directive("navbarloggedin",[function(){return{restrict:"EA",templateUrl:"directiveTemplates/larger_components/navbar-loggedIn_component.html"}}]).directive("navbarlower",[function(){return{restrict:"EA",templateUrl:"directiveTemplates/larger_components/navbar-lower_component.html"}}]).directive("optionsarea",[function(){return{restrict:"EA",templateUrl:"directiveTemplates/larger_components/options-area_component.html"}}]).directive("graphlargercomponents",[function(){return{restrict:"EA",templateUrl:"directiveTemplates/larger_components/graph_component.html"}}]).directive("logsmall",["$window",function(a){return{restrict:"EA",templateUrl:"directiveTemplates/larger_components/logsmall_component.html",link:function(b,c){angular.element(a).bind("resize",function(){angular.element(c[0]).children()[0].style.height=Math.round(a.innerWidth/3.45)+"px"}),angular.element(c[0]).children()[0].style.height=Math.round(a.innerWidth/3.45)+"px"}}}]).directive("loglarge",[function(){return{restrict:"EA",templateUrl:"directiveTemplates/larger_components/loglarge_component.html"}}]).directive("instructions",["$window",function(a){return{restrict:"EA",templateUrl:"directiveTemplates/larger_components/instructions_component.html",link:function(b,c){b.showInstructions=!1,angular.element(a).bind("resize",function(){angular.element(c[0])[0].style.height=Math.round(a.innerWidth/3.45)+"px"}),angular.element(c[0])[0].style.height=Math.round(a.innerWidth/3.45)+"px"}}}]),angular.module("app.graphDirective",[]).directive("graph",["d3","$window",function(a,b){return{restrict:"EA",scope:{data:"=",category:"=",select:"="},controller:function(){},link:function(c,d){function e(){i=Math.round(b.innerWidth/1.7756232687),j=Math.round(b.innerWidth/3.205),b.innerWidth<=400?(i=Math.round(b.innerWidth/1.1),j=Math.round(b.innerWidth/2)):b.innerWidth<=992&&(i=Math.round(b.innerWidth/1.05),j=Math.round(b.innerWidth/1.9)),k=m(b.innerWidth)}function f(){y&&(a.select("svg").remove(),y=a.select(d[0]).append("svg").attr("width",i).attr("height",j).attr("class","chart"),g(),h())}function g(){n=a.time.scale().domain(a.extent(l,function(a){return a.date})).range([k,i-k]),o=a.scale.linear().domain([0,a.max(l,function(a){return a.energylevel})]).range([j-k-10,k-10]),p=a.scale.linear().domain([0,5]).range([.1,.9]),sizeScale=a.scale.linear().domain([0,5]).range([6,13]),q=a.scale.linear().domain([0,a.max(l,function(a){return"exercise"===a.category?a.size:void 0})]).range([6,13]),r=a.scale.linear().domain([0,a.max(l,function(a){return"sleep"===a.category?a.size:void 0})]).range([6,13]),s=a.svg.axis().scale(n).orient("bottom").ticks(10),t=a.svg.axis().scale(o).orient("left").ticks(10),y.append("g").attr("class","x axis").attr("transform","translate(0,"+(j-k-10)+")").call(s),y.selectAll(".x.axis").selectAll("text").attr("transform","rotate(-45)translate(-20, 0)"),y.append("g").attr("class","y axis").attr("transform","translate("+k+",-10)").call(t).append("text").text("Energy Level").attr("x",i/2).attr("y",j/2).attr("transform",function(){return i>500?"rotate(-90 "+i/3.69+","+i/1.7+")":i>340?"rotate(-90 "+i/3.9+","+i/1.7+")":"rotate(-90 "+i/4.2+","+i/1.7+")"}),u=a.svg.line().x(function(a){return n(a.date)}).y(function(a){return o(a.energylevel)}),v=y.append("g").attr("class","linepath").append("path"),v.datum(l).attr("d",u).attr("class","line").on("mouseover",function(){a.select(this).attr("class","line_hover")}).on("mouseout",function(){a.select(this).attr("class","line")}),w=a.select("body").append("div").attr("class","tooltip").style("opacity",0),x=a.scale.category10()}function h(){var b=c.data,d=(c.category,a.time.scale().domain(a.extent(b,function(a){return a.date})).range([k,i-k])),e=a.scale.linear().domain([0,a.max(b,function(a){return a.energylevel})]).range([j-k-10,k-10]),f=a.scale.linear().domain([0,5]).range([6,13]),g=a.scale.linear().domain([0,a.max(b,function(a){return"exercise"===a.category?a.size:void 0})]).range([6,13]),h=a.scale.linear().domain([0,a.max(b,function(a){return"sleep"===a.category?a.size:void 0})]).range([6,13]),l=a.svg.axis().scale(d).orient("bottom").ticks(10),m=a.svg.axis().scale(e).orient("left").ticks(5),n=a.svg.line().x(function(a){return d(a.date)}).y(function(a){return e(a.energylevel)});y.select(".x.axis").transition().duration(500).call(l),y.selectAll(".x.axis").selectAll("text").attr("transform","rotate(-45)translate(-20, 0)"),y.select(".y.axis").transition().duration(500).call(m),v.datum(b).transition().duration(750).ease("linear").attr("d",n).attr("transform",null);var o=y.selectAll(".circles").data(b);o.enter().append("svg:circle").attr("class","circles").transition().duration(750).ease("linear").attr("cx",function(a){return d(a.date)}).attr("cy",function(a){return e(a.energylevel)}).attr("r",function(a){return"exercise"==a.category?g(a.size):"sleep"==a.category?h(a.size):f(a.size)}).attr("fill",function(a){return x(a.category)}).attr("opacity",function(a){return p(a.opacity)});var q=a.time.format("%a %b %e %I:%M:%S %p");o.on("mouseover",function(b){a.select(this).attr("opacity",1),showToolTipOnClick=!1,w.transition().duration(250).style("opacity",1),w.html(q(b.date)+"<br>"+b.note+"<br>"+b.category).style("left",a.event.pageX+"px").style("top",a.event.pageY-28+"px")}).on("mouseleave",function(){a.select(this).attr("opacity",function(a){return p(a.opacity)}),w.transition().duration(250).style("opacity",0)}).on("click",function(a){c.select=a}),o.transition().duration(750).ease("linear").attr("cx",function(a){return d(a.date)}).attr("cy",function(a){return e(a.energylevel)}).attr("fill",function(a){return x(a.category)}).attr("r",function(a){return"exercise"===a.category?g(a.size):"sleep"===a.category?h(a.size):f(a.size)}).attr("opacity",function(a){return p(a.opacity)}).style("cursor","pointer"),o.exit().remove()}{var i,j,k,l=c.data,m=(c.category,a.scale.linear().domain([320,2e3]).range([30,80]));a.scale.linear().domain([320,3e3]).range([300,1920])}e(),angular.element(b).bind("resize",function(){e(),f()
});var n,o,p,q,r,s,t,u,v,w,x,y=a.select(d[0]).append("svg").attr("width",i).attr("height",j).attr("class","chart");g(),c.$watch("data",h,!0),c.$watch("category",h,!0)}}}]),angular.module("app.services",[]).factory("EventService",["$http","$window","$cookieStore","$location","MockData",function(a,b,c,d,e){function f(a,b){n.authLevel>0?a():b()}function g(){function a(){}function b(){l=e}f(a,b)}function h(b,c,d){a({method:"post",url:"/post/event",headers:{"Content-type":"application/json",token:n.token},data:b}).success(function(){c()}).error(function(){d()})}function i(b,c){a({method:"get",url:"/get/events",headers:{"Content-type":"application/json",token:n.token}}).success(function(a){m.list=a.categories;for(var c=a.lifeEvents,d=0;d<c.length;d++)"string"==typeof c[d].date&&(c[d].date=new Date(c[d].date)),l.push(c[d]);b()}).error(function(){c()})}function j(b,c,d){a({method:"DELETE",url:"/delete/event",headers:{"Content-type":"application/json",token:n.token},data:b}).success(function(){for(var a=0;a<l.length;a++)if(b.date===l[a].date){l.splice(a,1);break}c()}).error(function(){d()})}function k(b,c,d){a({method:"PUT",url:"/put/event",headers:{"Content-type":"application/json",token:n.token},data:b}).success(function(){for(var a=0;a<l.length;a++)if(b.date===l[a].date){l.splice(a,1,b);break}c()}).error(function(){d()})}var l=[],m={},n={};n.token=null,n.authLevel=0;var o=c.get("user");return o&&(n=o,c.remove("user")),g(),{deleteLifeEvent:function(a,b,c){function d(){j(a,b,c)}function e(){for(var c=0;c<l.length;c++)if(a.date===l[c].date){l.splice(c,1);break}b()}f(d,e)},updateLifeEvent:function(a,b,c){function d(){k(a,b,c)}function e(){b()}f(d,e)},addLifeEvent:function(a,b,c){function d(){h(a,b,c)}function e(){b()}f(d,e)},getData:function(a,b){i(a,b)},login:function(){b.location.href="/auth/facebook/callback"},logout:function(b){a({method:"GET",url:"/logout",headers:{"Content-type":"application/json",token:n.token}}).success(function(){n.authLevel=0,d.path("/"),b()}).error(function(){})},Auth:n,allLifeEvents:l,categories:m}}]).factory("FilterService",["EventService",function(a){function b(a){if("day"===a)var b=Date.now()-864e5;else if("week"===a)var b=Date.now()-6048e5;else if("month"===a)var b=Date.now()-2592e6;else if("all"===a)var b=0;return b}function c(b,c){for(prop in a.allLifeEvents){var d=a.allLifeEvents,e=d[prop].date.valueOf();e>b&&e<Date.now()&&c.push(d[prop])}return c}function d(a){return a.sort(function(a,b){return a.date-b.date}),a}function e(b,c,d){for(prop in a.allLifeEvents){var e=a.allLifeEvents,f=e[prop].date.valueOf();f>=b&&c>=f&&d.push(e[prop])}return d}function f(b,c){for(prop in a.allLifeEvents){var d=a.allLifeEvents,e=d[prop].category;e==b&&c.push(d[prop])}return c}function g(b,c){for(prop in a.allLifeEvents){var d=a.allLifeEvents,e=d[prop].date.getHours();b===e&&c.push(d[prop])}return c}function h(b,c,d,e){for(prop in a.allLifeEvents){var f=a.allLifeEvents,g=f[prop].date.getDate(),h=f[prop].date.getMonth(),i=f[prop].date.getFullYear();b===g&&c===h&&d===i&&e.push(f[prop])}return e}function i(b,c){for(prop in a.allLifeEvents){var d=a.allLifeEvents,e=d[prop].energylevel;b===e&&c.push(d[prop])}return c}function j(b,c){for(prop in a.allLifeEvents){var d=a.allLifeEvents,e=d[prop].opacity;b===e&&c.push(d[prop])}return c}function k(b,c){for(prop in a.allLifeEvents){var d=a.allLifeEvents,e=d[prop].size;b===e&&c.push(d[prop])}return c}var l={};return l.time=null,l.lifeEvents=[],{filterLifeEvents:function(a){l.time=a,l.lifeEvents=[];var e=b(a);l.time=a;var f=c(e,l.lifeEvents);return l.lifeEvents=d(f),l.lifeEvents},sortTime:function(a){return d(a)},customFilterLifeEvents:function(a,b){l.lifeEvents=[];var c=e(a,b,l.lifeEvents);return l.lifeEvents=d(c),l.lifeEvents},filterActivity:function(a){l.lifeEvents=[];var b=f(a,l.lifeEvents);return l.lifeEvents=d(b),l.lifeEvents},filterHour:function(a){var b=a.getHours();l.lifeEvents=[];var c=g(b,l.lifeEvents);return l.lifeEvents=d(c),l.lifeEvents},filterDate:function(a){var b=a.getDate(),c=a.getMonth(),e=a.getFullYear();l.lifeEvents=[];var f=h(b,c,e,l.lifeEvents);return l.lifeEvents=d(f),l.lifeEvents},filterEnergy:function(a){l.lifeEvents=[];var b=i(a,l.lifeEvents);return l.lifeEvents=d(b),l.lifeEvents},filterOpacity:function(a){l.lifeEvents=[];var b=j(a,l.lifeEvents);return l.lifeEvents=d(b),l.lifeEvents},filterSize:function(a){l.lifeEvents=[];var b=k(a,l.lifeEvents);return l.lifeEvents=d(b),l.lifeEvents},currentFilterObj:l}}]).factory("CategoryService",["EventService","$rootScope","$http",function(a,b,c){function d(b,c){a.Auth.authLevel>0?b():c()}function e(b,d,e){c({method:"post",url:"/post/category",headers:{"Content-type":"application/json",token:a.Auth.token},data:b}).success(function(){g.list.push(b),d()}).error(function(){e()})}function f(b,d,e){c({method:"delete",url:"/delete/category",headers:{"Content-type":"application/json",token:a.Auth.token},data:b}).success(function(){for(var a=0;a<g.list.length;a++)if(g.list[a].label===b.label){g.list.splice(a,1);break}d()}).error(function(){e()})}var g={};return g.list=[{label:"Choose a category",value:"noCategoryChosen"},{label:"meal",value:"meal"},{label:"exercise",value:"exercise",size:"Minutes",opacity:"Intensity Level",show:"show.exercise",sizeCeiling:"180",opacityCeiling:"5"},{label:"work",value:"work",size:"Productivity",opacity:"Stress Level",show:"show.work",sizeCeiling:"5",opacityCeiling:"5"},{label:"sleep",value:"sleep",size:"Number of hours",opacity:"Sleep quality",show:"show.sleep",sizeCeiling:"12",opacityCeiling:"5"}],b.$watch(a.categories,function(){setTimeout(function(){a.categories.list&&(g.list=a.categories.list)},100)},!0),{addCategory:function(a,b,c){function f(){e(k,b,c)}function h(){g.list.push(k),b()}var i=/-?([_a-z]|[\240-\377])([_a-z0-9-]|[\240-\377])*/g,j=a.label.match(i).join(""),k={label:j,value:j,size:a.size,opacity:a.opacity,show:"show."+j,sizeCeiling:5,opacityCeiling:5};d(f,h)},deleteCategory:function(a,b,c){function e(){f(a,b,c)}function h(){for(var c=0;c<g.list.length;c++)if(g.list[c].label===a.label){g.list.splice(c,1);break}b()}d(e,h)},categoriesObj:g}}]).factory("MockData",[function(){var a=new Date,b=[{energylevel:2,note:"slept less than usual",date:new Date(a.getTime()-12276e5+Math.floor(18e5*Math.random())),category:"sleep",opacity:2,size:1},{energylevel:2,note:"slept less than usual",date:new Date(a.getTime()-12096e5+Math.floor(18e5*Math.random())),category:"sleep",opacity:2,size:1},{energylevel:3,note:"ran 3 miles",date:new Date(a.getTime()-1206e6+Math.floor(18e5*Math.random())),category:"exercise",opacity:4,size:40},{energylevel:4,note:"ate toast and eggs and milk",date:new Date(a.getTime()-12024e5+Math.floor(18e5*Math.random())),category:"meal",opacity:3,size:3},{energylevel:3,note:"a little tired.  should've slept more",date:new Date(a.getTime()-11988e5+Math.floor(18e5*Math.random())),category:"work",opacity:2.5,size:2.5},{energylevel:4,note:"ran 4 miles",date:new Date(a.getTime()-10368e5+Math.floor(18e5*Math.random())),category:"exercise",opacity:5,size:40},{energylevel:3,note:"normal sleep",date:new Date(a.getTime()-5544e5+Math.floor(18e5*Math.random())),category:"sleep",opacity:3,size:4},{energylevel:3,note:"normal sleep",category:"sleep",opacity:3,size:4,date:new Date(a.getTime()-5184e5+Math.floor(18e5*Math.random()))},{energylevel:2.5,note:"ate a huge meal",date:new Date(a.getTime()-5148e5+Math.floor(18e5*Math.random())),category:"meal",opacity:5,size:4},{energylevel:2.5,note:"good productivity for a few hours, getting tired",date:new Date(a.getTime()-504e6+Math.floor(18e5*Math.random())),category:"work",opacity:4,size:4},{energylevel:1,note:"very tired. drinking 2 coffees",date:new Date(a.getTime()-5004e5+Math.floor(18e5*Math.random())),category:"meal",opacity:1,size:1},{energylevel:5,note:"coffee is AWESOME",date:new Date(a.getTime()-4968e5+Math.floor(18e5*Math.random())),category:"work",opacity:5,size:5},{energylevel:2,note:"feeling sleepy",date:new Date(a.getTime()-3456e5+Math.floor(18e5*Math.random())),category:"work",opacity:2,size:2},{energylevel:3,note:"ran for 2 miles",date:new Date(a.getTime()-342e6+Math.floor(18e5*Math.random())),category:"exercise",opacity:30,size:4},{energylevel:4.5,note:"feeling better at work",date:new Date(a.getTime()-3384e5+Math.floor(18e5*Math.random())),category:"work",opacity:4,size:4}];return b}]),angular.module("ui.slider",[]).value("uiSliderConfig",{}).directive("uiSlider",["uiSliderConfig","$timeout",function(a,b){return a=a||{},{require:"ngModel",compile:function(){return function(c,d,e,f){function g(a,b){return b?parseFloat(a):parseInt(a)}function h(){d.slider("destroy")}var i=angular.extend(c.$eval(e.uiSlider)||{},a),j={min:null,max:null},k=function(){angular.isArray(f.$viewValue)&&i.range!==!0&&(i.range=!0),d.slider(i),k=angular.noop},l=["min","max","step"],m=angular.isUndefined(e.useDecimals)?!1:!0;$.each(l,function(a,b){e.$observe(b,function(a){a&&(k(),d.slider("option",b,g(a,m)))})}),e.$observe("disabled",function(a){k(),d.slider("option","disabled",!!a)}),c.$watch(e.uiSlider,function(a){k(),d.slider("option",a)},!0),b(k,0,!0),d.bind("slide",function(a,b){f.$setViewValue(b.values||b.value),c.$apply()}),f.$render=function(){k();var a=i.range===!0?"values":"value";f.$viewValue||(f.$viewValue=0),i.range===!0&&(angular.isDefined(i.min)&&i.min>f.$viewValue[0]&&(f.$viewValue[0]=i.min),angular.isDefined(i.max)&&i.max<f.$viewValue[1]&&(f.$viewValue[1]=i.max),f.$viewValue[0]>=f.$viewValue[1]&&(j.min>=f.$viewValue[1]&&(f.$viewValue[0]=j.min),j.max<=f.$viewValue[0]&&(f.$viewValue[1]=j.max)),j.min=f.$viewValue[0],j.max=f.$viewValue[1]),d.slider(a,f.$viewValue)},c.$watch(e.ngModel,function(){i.range===!0&&f.$render()},!0),d.bind("$destroy",h)}}}}]),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(a){var b=null;this.open=function(e){b||(a.bind("click",c),a.bind("keydown",d)),b&&b!==e&&(b.isOpen=!1),b=e},this.close=function(e){b===e&&(b=null,a.unbind("click",c),a.unbind("keydown",d))};var c=function(){b.$apply(function(){b.isOpen=!1})},d=function(a){27===a.which&&c()}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(a,b,c,d,e,f){var g,h=this,i=a.$new(),j=d.openClass,k=angular.noop,l=b.onToggle?c(b.onToggle):angular.noop;this.init=function(d){h.$element=d,b.isOpen&&(g=c(b.isOpen),k=g.assign,a.$watch(g,function(a){i.isOpen=!!a}))},this.toggle=function(a){return i.isOpen=arguments.length?!!a:!i.isOpen},this.isOpen=function(){return i.isOpen},i.$watch("isOpen",function(b){f[b?"addClass":"removeClass"](h.$element,j),b?e.open(i):e.close(i),k(a,b),l(a,{open:!!b})}),a.$on("$locationChangeSuccess",function(){i.isOpen=!1}),a.$on("$destroy",function(){i.$destroy()})}]).directive("dropdown",function(){return{restrict:"CA",controller:"DropdownController",link:function(a,b,c,d){d.init(b)}}}).directive("dropdownToggle",function(){return{restrict:"CA",require:"?^dropdown",link:function(a,b,c,d){if(d){var e=function(e){e.preventDefault(),e.stopPropagation(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.bind("click",e),b.attr({"aria-haspopup":!0,"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.unbind("click",e)})}}}}),function(){var a;a=angular.module("ngQuickDate",[]),a.provider("ngQuickDateDefaults",function(){return{options:{dateFormat:"M/d/yyyy",timeFormat:"h:mm a",labelFormat:null,placeholder:"Click to Set Date",hoverText:null,buttonIconHtml:null,closeButtonHtml:"&times;",nextLinkHtml:"Next &rarr;",prevLinkHtml:"&larr; Prev",disableTimepicker:!1,disableClearButton:!1,defaultTime:null,dayAbbreviations:["Su","M","Tu","W","Th","F","Sa"],dateFilter:null,parseDateFunction:function(a){var b;return b=Date.parse(a),isNaN(b)?null:new Date(b)}},$get:function(){return this.options},set:function(a,b){var c,d,e;if("object"==typeof a){e=[];for(c in a)d=a[c],e.push(this.options[c]=d);return e}return this.options[a]=b}}}),a.directive("datepicker",["ngQuickDateDefaults","$filter","$sce",function(a,b,c){return{restrict:"E",require:"ngModel",scope:{dateFilter:"=?",ngModel:"=",onChange:"&"},replace:!0,link:function(d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s;return k=f.debug&&f.debug.length,m=function(){return d.toggleCalendar(!1),d.weeks=[],d.inputDate=null,"string"==typeof d.ngModel&&(d.ngModel=n(d.ngModel)),"string"==typeof f.initValue&&(d.ngModel=n(f.initValue)),q(),r(),o()},q=function(){var b,e;for(b in a)e=a[b],b.match(/[Hh]tml/)?d[b]=c.trustAsHtml(a[b]||""):!d[b]&&f[b]?d[b]=f[b]:d[b]||(d[b]=a[b]);return d.labelFormat||(d.labelFormat=d.dateFormat,d.disableTimepicker||(d.labelFormat+=" "+d.timeFormat)),f.iconClass&&f.iconClass.length?d.buttonIconHtml=c.trustAsHtml("<i ng-show='iconClass' class='"+f.iconClass+"'></i>"):void 0},h=!1,window.document.addEventListener("click",function(){return h||(d.toggleCalendar(!1),d.$apply()),h=!1}),angular.element(e[0])[0].addEventListener("click",function(){return h=!0}),r=function(){return d.ngModel?(d.inputDate=b("date")(d.ngModel,a.dateFormat),d.inputTime=b("date")(d.ngModel,a.timeFormat)):(d.inputDate=null,d.inputTime=null)},o=function(){var a;return a=d.ngModel?new Date(d.ngModel):new Date,"Invalid Date"===a.toString()&&(a=new Date),a.setDate(1),d.calendarDate=new Date(a)},p=function(){var a,b,c,e,f,g,h,j,k,m,n,o,p,q;for(g=d.calendarDate.getDay(),e=l(d.calendarDate.getFullYear(),d.calendarDate.getMonth()),f=Math.ceil((g+e)/7),n=[],a=new Date(d.calendarDate),a.setDate(a.getDate()+-1*g),h=o=0,q=f-1;q>=0?q>=o:o>=q;h=q>=0?++o:--o)for(n.push([]),c=p=0;6>=p;c=++p)b=new Date(a),d.defaultTime&&(k=d.defaultTime.split(":"),b.setHours(k[0]||0),b.setMinutes(k[1]||0),b.setSeconds(k[2]||0)),j=d.ngModel&&b&&i(b,d.ngModel),m=i(b,new Date),n[h].push({date:b,selected:j,disabled:"function"==typeof d.dateFilter?!d.dateFilter(b):!1,other:b.getMonth()!==d.calendarDate.getMonth(),today:m}),a.setDate(a.getDate()+1);return d.weeks=n},g=function(a,c){return b("date")(a,c)},s=function(a){return"string"==typeof a?n(a):a},n=a.parseDateFunction,i=function(a,b,c){return null==c&&(c=!1),c?a-b===0:(a=s(a),b=s(b),a&&b&&a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate())},j=function(a,b){return a&&b?parseInt(a.getTime()/6e4)===parseInt(b.getTime()/6e4):!1},l=function(a,b){return[31,a%4===0&&a%100!==0||a%400===0?29:28,31,30,31,30,31,31,30,31,30,31][b]},d.$watch("ngModel",function(a,b){return a!==b&&(r(),o(),d.onChange&&!j(a,b))?d.onChange():void 0}),d.$watch("calendarDate",function(a,b){return a!==b?p():void 0}),d.$watch("calendarShown",function(){var a;return a=angular.element(e[0].querySelector(".quickdate-date-input"))[0],a.select()}),d.mainButtonStr=function(){return d.ngModel?b("date")(d.ngModel,d.labelFormat):d.placeholder},d.toggleCalendar=function(a){return d.calendarShown=isFinite(a)?a:!d.calendarShown},d.setDate=function(a,b){var c;return null==b&&(b=!0),c=!d.ngModel&&a||d.ngModel&&!a||a.getTime()!==s(d.ngModel).getTime(),"function"!=typeof d.dateFilter||d.dateFilter(a)?(d.ngModel=a,b&&d.toggleCalendar(!1),!0):!1},d.setDateFromInput=function(a){var b,c,e,f;null==a&&(a=!1);try{if(c=n(d.inputDate),!c)throw"Invalid Date";if(!d.disableTimepicker&&d.inputTime&&d.inputTime.length&&c){if(f=d.disableTimepicker?"00:00:00":d.inputTime,e=n(""+d.inputDate+" "+f),!e)throw"Invalid Time";c=e}if(!j(d.ngModel,c)&&!d.setDate(c,!1))throw"Invalid Date";return a&&d.toggleCalendar(!1),d.inputDateErr=!1,d.inputTimeErr=!1}catch(g){if(b=g,"Invalid Date"===b)return d.inputDateErr=!0;if("Invalid Time"===b)return d.inputTimeErr=!0}},d.onDateInputTab=function(){return d.disableTimepicker&&d.toggleCalendar(!1),!0},d.onTimeInputTab=function(){return d.toggleCalendar(!1),!0},d.nextMonth=function(){return d.calendarDate=new Date(new Date(d.calendarDate).setMonth(d.calendarDate.getMonth()+1))},d.prevMonth=function(){return d.calendarDate=new Date(new Date(d.calendarDate).setMonth(d.calendarDate.getMonth()-1))},d.clear=function(){return d.setDate(null,!0)},m(),p(),k?void 0:void 0},template:"<div class='quickdate'>\n  <a href='' ng-focus='toggleCalendar()' ng-click='toggleCalendar()' class='quickdate-button' title='{{hoverText}}'><div ng-hide='iconClass' ng-bind-html='buttonIconHtml'></div>{{mainButtonStr()}}</a>\n  <div class='quickdate-popup' ng-class='{open: calendarShown}'>\n    <a href='' tabindex='-1' class='quickdate-close' ng-click='toggleCalendar()'><div ng-bind-html='closeButtonHtml'></div></a>\n    <div class='quickdate-text-inputs'>\n      <div class='quickdate-input-wrapper'>\n        <label>Date</label>\n        <input class='quickdate-date-input' name='inputDate' type='text' ng-model='inputDate' placeholder='1/1/2013' ng-blur=\"setDateFromInput()\" ng-enter=\"setDateFromInput(true)\" ng-class=\"{'quickdate-error': inputDateErr}\" ng-tab='onDateInputTab()' />\n      </div>\n      <div class='quickdate-input-wrapper' ng-hide='disableTimepicker'>\n        <label>Time</label>\n        <input class='quickdate-time-input' name='inputTime' type='text' ng-model='inputTime' placeholder='12:00 PM' ng-blur=\"setDateFromInput(false)\" ng-enter=\"setDateFromInput(true)\" ng-class=\"{'quickdate-error': inputTimeErr}\" ng-tab='onTimeInputTab()'>\n      </div>\n    </div>\n    <div class='quickdate-calendar-header'>\n      <a href='' class='quickdate-prev-month quickdate-action-link' tabindex='-1' ng-click='prevMonth()'><div ng-bind-html='prevLinkHtml'></div></a>\n      <span class='quickdate-month'>{{calendarDate | date:'MMMM yyyy'}}</span>\n      <a href='' class='quickdate-next-month quickdate-action-link' ng-click='nextMonth()' tabindex='-1' ><div ng-bind-html='nextLinkHtml'></div></a>\n    </div>\n    <table class='quickdate-calendar'>\n      <thead>\n        <tr>\n          <th ng-repeat='day in dayAbbreviations'>{{day}}</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr ng-repeat='week in weeks'>\n          <td ng-mousedown='setDate(day.date)' ng-class='{\"other-month\": day.other, \"disabled-date\": day.disabled, \"selected\": day.selected, \"is-today\": day.today}' ng-repeat='day in week'>{{day.date | date:'d'}}</td>\n        </tr>\n      </tbody>\n    </table>\n    <div class='quickdate-popup-footer'>\n      <a href='' class='quickdate-clear' tabindex='-1' ng-hide='disableClearButton' ng-click='clear()'>Clear</a>\n    </div>\n  </div>\n</div>"}}]),a.directive("ngEnter",function(){return function(a,b,c){return b.bind("keydown keypress",function(b){return 13===b.which?(a.$apply(c.ngEnter),b.preventDefault()):void 0})}}),a.directive("ngTab",function(){return function(a,b,c){return b.bind("keydown keypress",function(b){return 9===b.which?a.$apply(c.ngTab):void 0})}})}.call(this);